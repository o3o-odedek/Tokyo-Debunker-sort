<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>도쿄 디벙커 캐릭터 소트</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; background-color: #f4f4f9; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        h1 { color: #333; margin-bottom: 30px; }
        .container { display: flex; gap: 20px; width: 90%; max-width: 600px; }
        .button { flex: 1; height: 200px; background: white; border: 2px solid #ddd; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); padding: 20px; text-align: center; }
        .button:hover { border-color: #6e8efb; transform: translateY(-5px); }
        .progress-bar { width: 90%; max-width: 600px; height: 10px; background: #ddd; border-radius: 5px; margin-bottom: 20px; overflow: hidden; }
        .progress { height: 100%; background: #6e8efb; width: 0%; transition: width 0.3s; }
        #result { display: none; width: 90%; max-width: 400px; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .result-item { padding: 10px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; }
    </style>
</head>
<body>

    <h1>도쿄 디벙커 캐릭터 소트</h1>
    
    <div class="progress-bar"><div class="progress" id="progress"></div></div>

    <div class="container" id="main-area">
        <div class="button" id="left-btn" onclick="select('left')">왼쪽</div>
        <div class="button" id="right-btn" onclick="select('right')">오른쪽</div>
    </div>

    <div id="result">
        <h2>소트 결과</h2>
        <div id="result-list"></div>
        <button onclick="location.reload()" style="margin-top:20px; width:100%; padding:10px; cursor:pointer;">다시 하기</button>
    </div>

    <script>
        // 캐릭터 리스트 
        const characters = ["카무라이 진", "이시바시 토우마", "루카스 에란트", "후지 카이토", "미도 아란", "하이조노 쇼헤이", "쿠로사기 레오", "카가미 스바루", "코토다마 젠지", "쿠사나기 하쿠", "이사미 유리", "키리사키 지로", "에드워드 하트", "라이카 콜트", "미즈키 루이", "사가라 하루", "시라나미 렌", "오토나시 토와", "호시바미 타이가", "신죠 리츠", "로미오 루치"];
        
        let list = characters.map(name => [name]);
        let mergedList = [];
        let leftIdx = 0, rightIdx = 0;
        let leftArr = [], rightArr = [];
        let tempMerged = [];
        let totalSteps = 0, currentStep = 0;

        function init() {
            // 대략적인 진행도 계산을 위한 총 단계 설정
            totalSteps = characters.length * Math.log2(characters.length);
            nextMerge();
        }

        function nextMerge() {
            if (list.length <= 1) {
                showResult(list[0]);
                return;
            }

            if (mergedList.length === 0) {
                while (list.length > 1) {
                    let a = list.shift();
                    let b = list.shift();
                    mergedList.push({a, b});
                }
                if (list.length === 1) mergedList.push({a: list.shift(), b: null});
            }

            let currentPair = mergedList[0];
            if (currentPair.b === null) {
                list.push(currentPair.a);
                mergedList.shift();
                nextMerge();
                return;
            }

            leftArr = currentPair.a;
            rightArr = currentPair.b;
            leftIdx = 0;
            rightIdx = 0;
            tempMerged = [];
            updateButtons();
        }

        function updateButtons() {
            document.getElementById('left-btn').innerText = leftArr[leftIdx];
            document.getElementById('right-btn').innerText = rightArr[rightIdx];
            
            currentStep++;
            let progress = Math.min((currentStep / totalSteps) * 100, 99);
            document.getElementById('progress').style.width = progress + "%";
        }

        function select(choice) {
            if (choice === 'left') {
                tempMerged.push(leftArr[leftIdx]);
                leftIdx++;
            } else {
                tempMerged.push(rightArr[rightIdx]);
                rightIdx++;
            }

            if (leftIdx < leftArr.length && rightIdx < rightArr.length) {
                updateButtons();
            } else {
                tempMerged = tempMerged.concat(leftArr.slice(leftIdx)).concat(rightArr.slice(rightIdx));
                list.push(tempMerged);
                mergedList.shift();
                nextMerge();
            }
        }

        function showResult(finalList) {
            document.getElementById('main-area').style.display = 'none';
            document.getElementById('progress').style.width = "100%";
            const resultDiv = document.getElementById('result');
            const resultList = document.getElementById('result-list');
            resultDiv.style.display = 'block';
            
            finalList.forEach((name, index) => {
                resultList.innerHTML += `<div class="result-item"><span>${index + 1}위</span> <span>${name}</span></div>`;
            });
        }

        init();
    </script>
</body>
</html>
